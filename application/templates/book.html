{% extends "layout.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block content %}

<div class="container" style="opacity:0.90;max-width: 500px;">
    <div class="jumbotron account">
        <div class="container">
            <img src="{{ url_for('static', filename='book_pics/' + book.image_book) }}" alt="" border="5" height=150 width=120 style="margin-bottom:30px">
        </div>
        <div class="container">
            <label class="labelbook"> Book name <h4 class="objectbook">{{book.book_name}}</h4></label><br>
            <label class="labelbook"> Author <h4 class="objectbook">{% for author in book.authors %}
            {{ author.author_name }}
            {% endfor %}</h4></label><br>
            <label class="labelbook">Category <h4 class="objectbook">{% for category in book.categories %}
            {{ category.category_name }}
            {% endfor %}</h4></label><br>
            <label class="labelbook">Date of issue<h4 class="objectbook">{{ book.date_of_issue }}</h4> </label><br>
            <label class="labelbook">Number of comments <h4 class="objectbook">{{ book.comments|length }}</h4></label><br>
            <label class="labelbook">Point <h4 class="objectbook">{{book.points }} / 10</h4></label>
        </div>
    </div>
</div>

<div class="container" style="opacity:0.90;max-width: 500px;">
    <div class="jumbotron">
        <div class="container">
            <h3>Comments</h3>
        </div>
        <div class="container">
            {% with messages = get_flashed_messages(category_filter=["danger"]) %}
            {% if messages %}
            {% for message in messages %}
                <div class="alert alert-danger">
                    <strong>Error!</strong> {{message}}
                </div>
            {% endfor %}
            {% endif %}
            {% endwith %}

            {% with messages = get_flashed_messages(category_filter=["success"]) %}
            {% if messages %}

            {% for message in messages %}
                <div class="alert alert-success">
                    <strong>Success!</strong> {{message}}
                </div>
            {% endfor %}
            {% endif %}
            {% endwith %}
            <form method="POST" action="">
                <dl>
                    {{wtf.quick_form(form)}}
                    <input class="btn btn-primary btn-block" type="submit" value="Comment">
                </dl>
            </form>
        </div>
        {% for comment in comments %}
        <div class="container">
            <div class="jumbotron" style="background-color:lightblue;padding:20px">
                <h4>{{comment.content}}</h4>
                <p style="text-align:right;margin-bottom:0px">{{comment.user.username}}</p>
                <p style="text-align:right">{{comment.creation_time}}</p>
            </div>
        </div>
        {% endfor %}
    </div>
</div>


{% endblock content %}